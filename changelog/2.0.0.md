# Scalameta 2.0.0

The full list of issues and merged PRs for this release is available here: https://github.com/scalameta/scalameta/milestone/3?closed=1

## Semantic API

The Semantic API offers operations to query information from the Scala compiler
such as naming resolution (`println` => `_root_.scala.Predef.println`), inferred type
annotations, reported compiler messages and more. This release introduces the
following improvements to the Semantic API

- ability to query for symbols of "hidden" code, including
  - inferred `.apply`/`.unapply`
  - inferred type annotations
  - inferred implicit arguments
  - inferred implicit conversions
  - extension methods (previously resolved to the implicit conversion)

  This opens possibilities for many exciting applications, including scalafix
  rewrites that expand inferred types/implicits.
- the module `semanticdb` is cross-published for 2.10, this opens the possibility
  to implement sbt plugins that emit subsets of semanticdb files, for example
  only reported messages, see
  [sbt-messagehost](https://github.com/olafurpg/sbt-messagehost).
- the module `semanticdb` no longer depends on `parsers` or other Scala-specific
  language features. This means it is possible to implement Semantic DB
  integrations for other languages than Scala.
- scalahost has been renamed to `semanticdb-scalac`
- `-P:semanticdb:failures:ignore/info/warning/error` to configure at which
  level semanticdb errors are reported.
- sbt-scalahost has been removed, add the semanticdb-scalac compiler plugin directly instead
- New Denotation.isJavaDefined to determine if a symbol is compiled with javac.
- Denotations are now emitted for all used symbols in a compilation unit.
- Several naming resolution bugs have been fixed, for example [#960][]
- Several Windows-related bugs have been fixed, our CI now runs tests on Appveyor for every PR
  to prevent further regressions.

```scala
// before in project/plugins.sbt
addSbtPlugin("org.scalameta" % "sbt-scalahost" % "1.8.0")
// after in build.sbt
addCompilerPlugin("org.scalameta" % "semanticdb-scalac" % "0.2.0" cross CrossVersion.full)
scalaOptions += "-Yrangepos"
```

## Tokenizers

- `enum` is now considered a keyword in the Dotty dialect
- Several XML literal issues have been fixed, by @allanrenucci

## Parsers

- New JavaScript facade to parse strings to JSON object, install on npm
  https://www.npmjs.com/package/scalameta-parsers, by @gabro
- Interactively explore `scala.meta.Tree` on https://astexplorer.net/, by @gabro
- Several parser bugs have been fixed, see [#942][], by @usrinivasan
- Reject case classes without parameter lists for Scala 2.11+, [#929][], by @jonas

## Trees

- The Tree AST has significantly changed in order to
  - TODO(xeno_by) motivate
  - reduce complexity
  - align closer with the tree API in [scalamacros/scalamacros](https://github.com/scalamacros/scalamacros).
- New `Tree.productFields: Seq[String]` field to get the field names of a tree node, useful in combination
  with `productIterator` and `productPrefix`.
- New `Type.ImplicitFunction` tree node for implicit function types in Dotty dialect.

## Quasiquotes

- TODO(xeno_by): summarize bug fixes in https://github.com/scalameta/scalameta/pull/1014

## IO

- `scala.meta.AbsolutePath/RelativePath` are now thin wrappers around `java.nio.file.Path`.
- `java.io.File` and `java.nio.file.Path` are now supported on Scala.js.
- Node.js APIs are lazily loaded preventing errors in the browser, see [#1059][], by @jonas

## Breaking changes

| 1.8.0                                             | 2.0.0                                               |
| -----                                             | -----                                               |
| scala.collection.immmutable.Seq[T]                | List[T]                                             |
| scala.meta.internal.ast                           | scala.meta.internal.trees                           |
| scala.meta.Term.TryWithCases                      | scala.meta.Term.Try                                 |
| scala.meta.Pat.Arg.SeqWildcard                    | scala.meta.Pat.SeqWildcard                          |
| scala.meta.Pat.Type                               | scala.meta.Type.Var                                 |
| scala.meta.Pat.Var.Term                           | scala.meta.Pat.Var                                  |
| scala.meta.Term.TryWithTerm                       | scala.meta.Term.TryWithHandler                      |
| scala.meta.Term.Param.Name                        | scala.meta.Name                                     |
| scala.meta.Term.Name.Qualifier                    | scala.meta.Name                                     |
| scala.meta.Term.Param in Template.self            | scala.meta.Self                                     |
| scala.meta.Term.New.templ: Template               | scala.meta.Term.New.init: Init                      |
| scala.meta.Term.Arg                               | scala.meta.Term                                     |
| scala.meta.Term.Update                            | scala.meta.Term.Assign(Apply())                     |
| scala.meta.Type.Arg.ByName                        | scala.meta.Type.ByName                              |
| scala.meta.Type.Arg.Repeated                      | scala.meta.Type.Repeated                            |
| scala.meta.Term.Unit(())                          | scala.meta.Term.Unit()                              |
| scala.meta.Term.Null(null)                        | scala.meta.Term.Null()                              |
| scala.meta.Template.stats: Option[Seq[Stat]]      | scala.meta.Template.stats: List[Stat]               |
| scala.meta.Mod.Annot.body: Term                   | scala.meta.Mod.Annot.init: Init                     |
| scala.meta.Mirror                                 | scala.meta.Database                                 |
| scala.meta.Ctor.Select                            | Removed, made redundant.                            |
| scala.meta.Ctor.Name("this")                      | scala.meta.Name.Anonymous()                         |
| scala.meta.Point                                  | Removed, use `Range(start, start)` instead          |
| scala.meta.Position.Range.start/end: Point        | scala.meta.Position.Range.start/end: Int            |
| scala.meta.Position.Range.start/end.line: Point   | scala.meta.Position.Range.startLine/endLine: Int    |
| scala.meta.Position.Range.start/end.column: Point | scala.meta.Position.Range.startColumn/enColumn: Int |

Examples:

| 1.8.0                                                                                                                                        | 2.0.0                                                                                                                           |
| -----                                                                                                                                        | -----                                                                                                                           |
| `scala.meta.Ctor.Name("B")` in Template                                                                                                        | `scala.meta.(Init(Type.Name("B"), Name.Anonymous(), Nil))`                                                                        |
| `q"new X" == Term.New(Template(List(), List(Ctor.Ref.Name("X")), Term.Param(List(), _, None, None), None))`                                  | `q"new X" == Term.New(Init(Type.Name("X"), _, List()))`                                                                         |
| `q"new X {self=>}" == Term.New(Template(List(), List(Ctor.Ref.Name("X")), Term.Param(List(), Term.Name("self"), None, None), Some(List())))` | `q"new X" == Term.NewAnonymous(Template(List(), List(Init(Type.Name("X"), _, List())), Self(Term.Name("self"), None), List()))` |



## Contributors

`git shortlog -sn --no-merges v1.8.0..v2.0.0` tells us that 11 people contributed to this release:

- Ólafur Páll Geirsson
- Eugene Burmako
- Gabriele Petronella
- Jonas Fonseca
- Allan Renucci
- Uma Srinivasan
- Travis
- Xavier Fernández Salas
- jvican
- Martijn Hoekstra
- Jason Zaugg

[#1059]: https://github.com/scalameta/scalameta/issues/1059
[#942]: https://github.com/scalameta/scalameta/issues/942
[#929]: https://github.com/scalameta/scalameta/issues/929
[#960]: https://github.com/scalameta/scalameta/issues/960
